<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Altın Hesaplama (Kişisel)</title>

<style>
body {
  background:#111;
  color:#eee;
  font-family:Arial, sans-serif;
  max-width:520px;
  margin:auto;
  padding:20px;
}
h2 { margin-bottom:15px; }

.satir {
  display:flex;
  gap:8px;
  align-items:center;
  margin-bottom:8px;
}
.satir span {
  width:150px;
  font-size:14px;
}
.satir input {
  width:90px;
  padding:6px;
}
.satir .tl {
  width:110px;
  font-size:13px;
  color:#00ff99;
}

.butonlar {
  display:flex;
  gap:10px;
  margin-top:15px;
}
button {
  flex:1;
  padding:10px;
  font-size:15px;
  cursor:pointer;
  border:none;
}
.hesapla { background:#00ff99; }
.sifirla { background:#444; color:#eee; }

.toplam {
  margin-top:20px;
  font-size:20px;
  color:#00ff99;
}

.hata {
  margin-top:10px;
  color:#ff5555;
  font-size:13px;
}
</style>
</head>

<body>

<h2>Altın Hesaplama</h2>

<div id="liste"></div>

<div class="butonlar">
  <button class="hesapla" id="hesaplaBtn">Hesapla</button>
  <button class="sifirla" id="sifirlaBtn">Sıfırla</button>
</div>

<div class="toplam" id="toplam">Toplam: —</div>
<div class="hata" id="hata"></div>

<script>
const API_KEY = "BURAYA_API_KEY_YAZ";

const altinListesi = [
  "22 Ayar Gram Altın",
  "Çeyrek Altın",
  "Yarım Altın",
  "Ata Altın",
  "Reşat Altın"
];

let fiyatlar = {};

async function fiyatlariCek() {
  try {
    const res = await fetch(
      "https://api.collectapi.com/economy/goldPrice",
      { headers:{ authorization:"apikey " + API_KEY } }
    );
    const data = await res.json();

    data.result.forEach(item => {
      if (altinListesi.includes(item.name)) {
        fiyatlar[item.name] = Number(item.selling);
      }
    });

    arayuzKur();
  } catch (e) {
    document.getElementById("hata").innerText =
      "Fiyatlar alınamadı. API çalışmıyor olabilir.";
  }
}

function arayuzKur() {
  const liste = document.getElementById("liste");

  altinListesi.forEach(ad => {
    const div = document.createElement("div");
    div.className = "satir";
    div.innerHTML = `
      <span>${ad}</span>
      <input type="number" step="0.01" data-ad="${ad}">
      <div class="tl" data-sonuc="${ad}">—</div>
    `;
    liste.appendChild(div);
  });
}

function hesapla() {
  let toplam = 0;
  document.getElementById("hata").innerText = "";

  document.querySelectorAll("input").forEach(inp => {
    const ad = inp.dataset.ad;
    const miktar = Number(inp.value);
    const sonucDiv = document.querySelector(`[data-sonuc="${ad}"]`);

    if (!isNaN(miktar) && miktar > 0 && fiyatlar[ad]) {
      const tutar = miktar * fiyatlar[ad];
      sonucDiv.innerText = tutar.toFixed(2) + " TL";
      toplam += tutar;
    } else {
      sonucDiv.innerText = "—";
    }
  });

  document.getElementById("toplam").innerText =
    "Toplam: " + toplam.toFixed(2) + " TL";
}

function sifirla() {
  document.querySelectorAll("input").forEach(i => i.value = "");
  document.querySelectorAll(".tl").forEach(d => d.innerText = "—");
  document.getElementById("toplam").innerText = "Toplam: —";
  document.getElementById("hata").innerText = "";
}

document.getElementById("hesaplaBtn").addEventListener("click", hesapla);
document.getElementById("sifirlaBtn").addEventListener("click", sifirla);

// Enter = hesapla
document.addEventListener("keydown", e => {
  if (e.key === "Enter") hesapla();
});

fiyatlariCek();
</script>

</body>
</html>
